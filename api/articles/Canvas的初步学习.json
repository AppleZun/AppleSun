{"title":"Canvas的初步学习","slug":"Canvas的初步学习","date":"2016-09-04T23:21:28.000Z","updated":"2017-06-29T01:14:13.549Z","comments":true,"excerpt":"<p>HTML5新增便签canvas，从他出生似乎很有争议：有人看好canvas的强大操作性，觉得移动端游戏开发可以依靠canvas侵占市场；有人看悲他，因为不够成熟的API，并不足以完成 HTML5 的重大期望。不过，作为HTML5 的一部分，还有有必要去学习了解canvas的。</p>","content":"<p>HTML5新增便签canvas，从他出生似乎很有争议：有人看好canvas的强大操作性，觉得移动端游戏开发可以依靠canvas侵占市场；有人看悲他，因为不够成熟的API，并不足以完成 HTML5 的重大期望。不过，作为HTML5 的一部分，还有有必要去学习了解canvas的。</p>\n<a id=\"more\"></a>\n<h3 id=\"明确：Canvas-能做什么？\"><a href=\"#明确：Canvas-能做什么？\" class=\"headerlink\" title=\"明确：Canvas 能做什么？\"></a>明确：Canvas 能做什么？</h3><ul>\n<li><code>游戏开发</code>：替代Flash游戏是他的根本使命，流畅度跨平台能发挥潜力</li>\n<li><code>图表制作</code>：不过实际生产过程中会考虑使用<code>SVG</code>或者<code>ECharts</code>来实现</li>\n<li><code>banner广告</code>：同样是取代flash在广告的领域</li>\n<li><code>字体图片设计</code>：字体的自定义渲染可以通过HTML5技术实现</li>\n<li><code>模拟器</code>：无论从视觉效果还是核心功能方面来说，模拟器产品可以完全由JavaScript来实现</li>\n<li><code>其他可嵌入网站的内容</code>：类似音频、视频等，能更好地与Web融合</li>\n<li>and so on</li>\n</ul>\n<h3 id=\"基础知识学习\"><a href=\"#基础知识学习\" class=\"headerlink\" title=\"基础知识学习\"></a>基础知识学习</h3><p>HTML：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;canvas id=&quot;canvas&quot; width=&quot;800&quot; height=&quot;600&quot;&gt;您的浏览器版本过低，请升级您的浏览器&lt;/canvas&gt;//宽高属性直接在canvas行间设置</div></pre></td></tr></table></figure>\n<p>script：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">var canvas = document.getElementById(&apos;canvas&apos;)</div><div class=\"line\">var context = canvas.getContext(&apos;2d&apos;)//当前参数仅支持2d，以后可能有“3d”参数</div><div class=\"line\">context.beginPath()//在新的图层上渲染</div><div class=\"line\">context.fillStyle=&quot;#fff&quot;//此处为填充颜色的选择</div><div class=\"line\">context.strokeStyle=&quot;blue&quot;//此处为描边颜色的选择</div><div class=\"line\">context.arc(x,y,r,degS,degE)//参数分别为“圆心横坐标”，“圆心纵坐标”，“圆心半径”，“起始弧度”，“终止弧度”</div><div class=\"line\">context.rect(x,y,wid,heig)//参数分别为“起点横坐标”，“起点纵坐标”，“矩形宽”，“矩形高”</div><div class=\"line\">context.fill()//确认填充区域</div><div class=\"line\">context.stroke()//确认描边</div><div class=\"line\">context.lineWidth=3//线宽</div><div class=\"line\">context.moTo(x1,y1)//讲画笔移到起始点</div><div class=\"line\">context.lineTo(x2,y2)//以上一个点连接到当前点作画</div><div class=\"line\">context.closePath()//闭合封闭图形</div></pre></td></tr></table></figure>\n<ul>\n<li>其中要注意的就是 当出现 context.rotate();context.scale();context.translate()时，要配合使用context.save();context.restore()。可以理解为游戏的存档与读档;以rotate为例，使用方法如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">context.save();//保存上面</div><div class=\"line\">context.rotate(Math.PI*2);//顺时针旋转2π</div><div class=\"line\">context.fillStyle=&quot;red&quot;//填充色为红色</div><div class=\"line\">context.translate(50，50)讲原点移动到50，50 的位置</div><div class=\"line\">context.fillRect(0,0,100,200);//填充一个100*200的红色矩形（实际是在50，50的位置绘制的）</div><div class=\"line\">context.restore();//恢复保存</div><div class=\"line\">context.fillRect(0,0,300,200);//此时填充一个黑色的（默认颜色）300*200的矩形（依然是在0，0的位置绘制）</div></pre></td></tr></table></figure>\n<p><img src=\"http://7xjdah.com1.z0.glb.clouddn.com/pic2016051644.png\" alt=\"img\"></p>\n<h5 id=\"完成上图内容，完成基础知识的考核\"><a href=\"#完成上图内容，完成基础知识的考核\" class=\"headerlink\" title=\"完成上图内容，完成基础知识的考核\"></a>完成上图内容，完成基础知识的考核</h5><h4 id=\"案例1：clock-demo\"><a href=\"#案例1：clock-demo\" class=\"headerlink\" title=\"案例1：clock demo\"></a>案例1：clock demo</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div></pre></td><td class=\"code\"><pre><div class=\"line\">HTML:</div><div class=\"line\">    &lt;canvas id=&quot;canvas&quot; width=400 height=400&gt;</div><div class=\"line\"></div><div class=\"line\">SCRIPT:</div><div class=\"line\">    var canvas = document.getElementById(&apos;canvas&apos;)</div><div class=\"line\">    var context = canvas.getContext(&apos;2d&apos;)</div><div class=\"line\">    var r = canvas.width/2</div><div class=\"line\">    var anglePerHour = Math.PI/6</div><div class=\"line\">    var anglePerMinute = Math.PI/30</div><div class=\"line\">    var anglePerSecond = Math.PI/30</div><div class=\"line\">        context.translate(r,r)</div><div class=\"line\">    function surface() &#123;</div><div class=\"line\">        context.fillStyle=&quot;purple&quot;</div><div class=\"line\">        context.lineCap=&quot;round&quot;</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        context.arc(0,0,r,0,Math.PI*2,true)</div><div class=\"line\">        context.fill()</div><div class=\"line\">        //时针刻度</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        context.strokeStyle=&quot;#fff&quot;</div><div class=\"line\">        context.lineWidth=10</div><div class=\"line\">        for (var i = 0; i &lt; 12; i++) &#123;</div><div class=\"line\">            context.save()</div><div class=\"line\">            context.rotate(anglePerHour*i)</div><div class=\"line\">            context.moveTo(r-40,0)</div><div class=\"line\">            context.lineTo(r-5,0)</div><div class=\"line\">            context.stroke()</div><div class=\"line\">            context.restore()</div><div class=\"line\">        &#125;</div><div class=\"line\">        //分针刻度</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        context.strokeStyle=&quot;#0ff&quot;</div><div class=\"line\">        context.lineWidth=5</div><div class=\"line\">        for (var i = 0; i &lt; 60; i++) &#123;</div><div class=\"line\">            if (i%5!=0) &#123;</div><div class=\"line\">                context.save()</div><div class=\"line\">                context.rotate(anglePerMinute*i)</div><div class=\"line\">                context.moveTo(r-25,0)</div><div class=\"line\">                context.lineTo(r-5,0)</div><div class=\"line\">                context.stroke()</div><div class=\"line\">                context.restore()</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    function timeGo() &#123;</div><div class=\"line\">        var date = new Date()</div><div class=\"line\">        var hour = date.getHours()</div><div class=\"line\">        var minute = date.getMinutes()</div><div class=\"line\">        var second = date.getSeconds()</div><div class=\"line\">        //时针</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        context.strokeStyle=&quot;#f0f&quot;</div><div class=\"line\">        context.lineWidth=8</div><div class=\"line\">        context.save()</div><div class=\"line\">        context.rotate(anglePerHour*hour+anglePerMinute*minute/12+anglePerSecond*second/60/12-Math.PI/2)</div><div class=\"line\">        context.moveTo(0,0)</div><div class=\"line\">        context.lineTo(100,0)</div><div class=\"line\">        context.stroke()</div><div class=\"line\">        context.restore()</div><div class=\"line\">        //分针</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        context.strokeStyle=&quot;#ff0&quot;</div><div class=\"line\">        context.lineWidth=6</div><div class=\"line\">        context.save()</div><div class=\"line\">        context.rotate(anglePerMinute*minute+anglePerSecond*second/60-Math.PI/2)</div><div class=\"line\">        context.moveTo(0,0)</div><div class=\"line\">        context.lineTo(120,0)</div><div class=\"line\">        context.stroke()</div><div class=\"line\">        context.restore()</div><div class=\"line\">        //秒针</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        context.strokeStyle=&quot;#f3f3f3&quot;</div><div class=\"line\">        context.lineWidth=4</div><div class=\"line\">        context.save()</div><div class=\"line\">        context.rotate(anglePerSecond*second-Math.PI/2)</div><div class=\"line\">        context.moveTo(0,0)</div><div class=\"line\">        context.lineTo(150,0)</div><div class=\"line\">        context.stroke()</div><div class=\"line\">        context.restore()</div><div class=\"line\">    &#125;</div><div class=\"line\">    surface()</div><div class=\"line\">    timeGo()</div><div class=\"line\">    setInterval(function () &#123;</div><div class=\"line\">        context.clearRect(-r,-r,400,400)</div><div class=\"line\">        surface()</div><div class=\"line\">        timeGo()</div><div class=\"line\">    &#125;, 500)</div></pre></td></tr></table></figure>\n<h2 id=\"点击这里查看Online-Clock在线演示\"><a href=\"#点击这里查看Online-Clock在线演示\" class=\"headerlink\" title=\"点击这里查看Online-Clock在线演示\"></a><a href=\"http://crackerme.github.io/DemoForCanvas/\" target=\"_blank\" rel=\"external\">点击这里查看Online-Clock在线演示</a></h2><h4 id=\"案例2：在线涂鸦\"><a href=\"#案例2：在线涂鸦\" class=\"headerlink\" title=\"案例2：在线涂鸦\"></a>案例2：在线涂鸦</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\">HTML:</div><div class=\"line\">    &lt;canvas id=”canvas” width=600 height=400&gt;</div><div class=\"line\">SCRIPT:</div><div class=\"line\">    var canvas = document.getElementById(‘canvas’)</div><div class=\"line\">    var context = canvas.getContext(‘2d’)</div><div class=\"line\">    canvas.onmousedown=function (e) &#123;</div><div class=\"line\">        context.beginPath()</div><div class=\"line\">        var ev = ev||window.event</div><div class=\"line\">        var disX = ev.clientX-canvas.offsetLeft;</div><div class=\"line\">        var disY = ev.clientY-canvas.offsetTop;</div><div class=\"line\">        context.moveTo(disX,disY)</div><div class=\"line\">document.onmousemove=function (e) &#123;</div><div class=\"line\">            var ev = ev||window.event</div><div class=\"line\">            var dX = ev.clientX-canvas.offsetLeft;</div><div class=\"line\">            var dY = ev.clientY-canvas.offsetTop;</div><div class=\"line\">            var gradient = context.createLinearGradient(0,0,600,400)</div><div class=\"line\">            gradient.addColorStop(0,’red’)</div><div class=\"line\">            gradient.addColorStop(0.2,’orange’)</div><div class=\"line\">            gradient.addColorStop(0.4,’yellow’)</div><div class=\"line\">            gradient.addColorStop(0.6,’green’)</div><div class=\"line\">            gradient.addColorStop(0.8,’blue’)</div><div class=\"line\">            gradient.addColorStop(1,’purple’)</div><div class=\"line\">            context.strokeStyle=gradient;</div><div class=\"line\">            // context.strokeStyle=”red”</div><div class=\"line\">            context.lineWidth=3</div><div class=\"line\">            context.lineTo(dX,dY)</div><div class=\"line\">            context.stroke()&#125;</div><div class=\"line\">document.onmouseup=function()&#123;</div><div class=\"line\">    document.onmousemove=null&#125;&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"点击这里查看Free-Doodle在线演示\"><a href=\"#点击这里查看Free-Doodle在线演示\" class=\"headerlink\" title=\"点击这里查看Free Doodle在线演示\"></a><a href=\"http://crackerme.github.io/DemoForCanvas/\" target=\"_blank\" rel=\"external\">点击这里查看Free Doodle在线演示</a></h2><h4 id=\"手机状态下预览不佳，建议使用PC登陆查看，谢谢合作\"><a href=\"#手机状态下预览不佳，建议使用PC登陆查看，谢谢合作\" class=\"headerlink\" title=\"手机状态下预览不佳，建议使用PC登陆查看，谢谢合作\"></a>手机状态下预览不佳，建议使用PC登陆查看，谢谢合作</h4><p>未完待续。。。</p>\n<p><em>Yours Sincerely SunPing</em></p>\n","categories":[],"tags":[{"name":"html5","path":"api/tags/html5.json"}]}